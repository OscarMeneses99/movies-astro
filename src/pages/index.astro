---
import Layout from "../layouts/Layout.astro";
import Title from "../components/Title.astro";
import ListOfMovies from "../components/ListOfMovies.astro";

async function getTitle() {
  if (Astro.request.method === "POST") {
    const data = await Astro.request.formData();
    const title = data.get("title");
    return title;
  }
}

const title = await getTitle();
---

<Layout title="Movies">
  <main class="m-auto max-w-xl flex flex-col">
    <Title />
    <form method="POST">
      <input
        type="text"
        name="title"
        placeholder="Search for a movie..."
        class="mx-auto block mb-10 p-3 w-1/2 border-2 border-teal-500 rounded-lg focus:outline-none focus:border-teal-500"
      />
    </form>
    {
      title && (
        <p class="text-center text-2xl mb-10">
          Showing results for <span class="font-bold">{title}</span>
        </p>
      )
    }
    <ListOfMovies search={title} />
  </main>
</Layout>
